<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OXVA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./assets/fonts/fonts.css" />
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1/bundled/lenis.min.js"></script>
  </head>
  <body
    class="bg-[#c4341e] text-white h-[100svh] w-screen text-[3svh] position-relative overflow-x-hidden"
  >
    <nav
      class="flex w-full justify-between px-[5svw] py-[3svh] z-[100] fixed top-0 left-0"
    >
      <div class="hover:cursor-pointer">
        <img
          src="./assets/images/oxperience_logo.svg"
          alt="oxperience_logo"
          class="h-[10svh] w-auto"
        />
      </div>
      <div
        class="flex items-center font-roboto-mono font-normal uppercase text-[3svh] leading-[2.5svh]"
      >
        <div class="hover:cursor-pointer hover:underline">Countdown</div>
        <div
          class="hover:cursor-pointer hover:underline px-[2svh] mx-[2svh] border-x-[.25svh]"
        >
          About
        </div>
        <div class="hover:cursor-pointer hover:underline">Ticket Info</div>
      </div>
    </nav>
    <div
      class="absolute top-[-40svh] left-[-25svw] w-full h-full bg-black-50 z-[1] pointer-events-none"
    >
      <img
        src="./assets/images/animation-a.gif"
        alt="animation-a"
        class="h-[150svh] w-auto"
      />
    </div>
    <div
      class="absolute bottom-[-10svh] right-[-60svw] w-full h-full bg-black-50 z-[1] pointer-events-none"
    >
      <img
        src="./assets/images/animation-b.gif"
        alt="animation-b"
        class="h-[130svh] w-auto"
      />
    </div>
    <div
      class="absolute top-[150svh] right-[-30svw] w-full h-full bg-black-50 z-[1] pointer-events-none"
    >
      <img
        src="./assets/images/animation-c.gif"
        alt="animation-a"
        class="h-[100svh] w-auto"
      />
    </div>
    <div
      class="absolute top-[130svh] right-[-50svw] w-full h-full bg-black-50 z-[1] pointer-events-none"
    >
      <img
        src="./assets/images/animation-d.gif"
        alt="animation-b"
        class="h-[170svh] w-auto"
      />
    </div>
    <section
      class="flex flex-col justify-center items-center h-[100svh] w-full relative z-[50] bg-transparent"
    >
      <div
        class="font-anona font-bold uppercase text-[8svw] leading-[7svw] text-center"
      >
        <span class="mr-[26.4svw]">Wander to</span> <br />
        <span class="ml-[38svw]">Flavors</span>
      </div>
      <div class="w-[80svw] h-[.3svh] bg-white my-[4svh]" />
      <div
        class="font-roboto-mono w-full flex justify-center font-normal uppercase text-[6svw] leading-[8svw]"
        id="countdown"
      >
        X DAYS TO GO
      </div>
    </section>
    <section
      class="flex w-full min-h-[90svh] justify-center items-center px-[8svw] pt-[8svh]  relative z-[50] mt-[20svh]"
    >
      <div
        class="flex flex-col text-left flex-1 gap-[5svh] h-[80svh] border-r-[0.25svh] pr-[10svh]"
      >
        <div class="uppercase font-bold text-[4svh] tracking-wider">About</div>
        <div
          class="font-roboto-mono font-normal text-[2.7svh] flex flex-col gap-[4svh]"
        >
          <p>
            An experience designed to take the audience on a journey of sensory
            euphoria through music and breathtaking scenery of flavors.
          </p>
          <p>
            This festival is held in celebration of oxvaâ€™s 6th
            anniversary,marking a milestone in its journey. A music festival was
            organized to provide fans with an unforgettable experience.
          </p>
          <p>
            Beyond that, this event also serves as a platform for oxva to
            enhance brand engagement and awareness, while potentially expanding
            its customer base to include vaping enthusiasts.
          </p>
        </div>
      </div>
      <div
        class="flex flex-col text-left flex-1 pl-[10svh] justify-start h-[80svh]"
      >
        <div class="uppercase font-bold text-[10svh] leading-[11svh]">
          JKT <br />
          IDN 2025 <br />
          COMING SOON
        </div>

        <div class="w-[51svh] h-[.3svh] bg-white my-[4svh]" />
      </div>
      <!-- <div
        class="absolute bottom-0 left-0 w-full h-[10svh] bg-gradient-to-b from-transparent to-[#c4341e] z-[0]"
      ></div> -->
    </section>
    <section
      class="h-[110svh] w-full relative z-[0] flex flex-col px-[8svw] overflow-hidden"
    >
      <canvas
        id="ticketBackground"
        class="absolute inset-0 w-full h-full z-[-1]"
        style="background-color: #c33723"
      ></canvas>
      
      <div
        class="absolute top-0 left-0 w-full h-[30svh] bg-gradient-to-b from-[#c33723] to-transparent z-[0]"
      ></div>
      <div class="uppercase font-bold text-[4svh] tracking-wider mt-[30svh]">
        Ticket Information
      </div>
      <div class="w-full h-full flex justify-center items-center">
        <div
          class="h-[20svh] w-[68svh] mb-[10svh] relative cursor-pointer group flex justify-center items-center"
        >
          <img
            src="./assets/images/ticket-outline.svg"
            alt="ticket-button"
            class="absolute top-0 left-0 h-full w-full object-contain transition-opacity duration-300 group-hover:opacity-0"
          />
          <img
            src="./assets/images/ticket-fill.svg"
            alt="ticket-button"
            class="absolute top-0 left-0 h-full w-full object-contain opacity-0 transition-opacity duration-300 group-hover:opacity-100"
          />
          <div class="font-bold text-[6svh] tracking-wider uppercase">
            Buy Ticket
          </div>
        </div>
      </div>
    </section>

    <script>
      // Initialize Lenis smooth scrolling
      const lenis = new Lenis({
        duration: 1.2,
        easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
        direction: "vertical",
        gestureDirection: "vertical",
        smooth: true,
        mouseMultiplier: 1,
        smoothTouch: false,
        touchMultiplier: 2,
        infinite: false,
      });

      function raf(time) {
        lenis.raf(time);
        requestAnimationFrame(raf);
      }

      requestAnimationFrame(raf);

      // Countdown to November 15, 2025, GMT+7
      let animationInterval;
      let isAnimating = false;
      let lastDisplayedValue = null;
      let lastDisplayedUnit = null;

      function animateNumber(targetNumber, unit) {
        if (isAnimating) return;

        // Check if the value has actually changed
        if (lastDisplayedValue === targetNumber && lastDisplayedUnit === unit) {
          return; // Don't animate if the same value is already displayed
        }

        isAnimating = true;

        let currentNumber = Math.floor(Math.random() * 999) + 1;
        const countdownElement = document.getElementById("countdown");
        let animationCount = 0;
        const maxAnimations = 20;

        animationInterval = setInterval(() => {
          if (animationCount < maxAnimations) {
            currentNumber = Math.floor(Math.random() * 999) + 1;
            countdownElement.textContent = `${currentNumber} ${unit} to go`;
            animationCount++;
          } else {
            clearInterval(animationInterval);
            countdownElement.textContent = `${targetNumber} ${unit} to go`;
            lastDisplayedValue = targetNumber;
            lastDisplayedUnit = unit;
            isAnimating = false;
          }
        }, 100);
      }

      function updateCountdown() {
        // Target date: November 15, 2025, 00:00:00 GMT+7
        const targetDate = new Date("2025-11-15T00:00:00+07:00");
        const now = new Date();

        // Calculate the difference
        const difference = targetDate - now;

        if (difference > 0) {
          // Calculate days, hours, minutes, seconds
          const days = Math.floor(difference / (1000 * 60 * 60 * 24));
          const hours = Math.floor(
            (difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
          );
          const minutes = Math.floor(
            (difference % (1000 * 60 * 60)) / (1000 * 60)
          );
          const seconds = Math.floor((difference % (1000 * 60)) / 1000);

          // Determine which unit to show and animate
          if (days > 0) {
            animateNumber(days, "days");
          } else if (hours > 0) {
            animateNumber(hours, "hours");
          } else if (minutes > 0) {
            animateNumber(minutes, "minutes");
          } else {
            animateNumber(seconds, "seconds");
          }
        } else {
          // Event has passed
          document.getElementById("countdown").textContent =
            "Event has started!";
        }
      }

      // Start with animated placeholder
      document.getElementById("countdown").textContent = "x days to go";

      // Update countdown every second
      setInterval(updateCountdown, 1000);

      // Initial update after a short delay
      setTimeout(updateCountdown, 500);

      // WebGL Background for Ticket Section
      function initTicketBackground() {
        const canvas = document.getElementById("ticketBackground");

        if (!canvas) {
          console.warn("Canvas not found");
          return;
        }

        const gl =
          canvas.getContext("webgl") || canvas.getContext("experimental-webgl");

        if (!gl) {
          console.warn("WebGL not supported");
          return;
        }

        console.log("WebGL initialized successfully");

        // Vertex shader
        const vertexShaderSource = `
          attribute vec2 a_position;
          void main() {
            gl_Position = vec4(a_position, 0.0, 1.0);
          }
        `;

        // Fragment shader with soft spotlights
        const fragmentShaderSource = `
          precision mediump float;
          uniform vec2 u_resolution;
          uniform float u_time;
          
          vec3 blue = vec3(0.2, 0.0, 1.0);          // More vivid blue
          vec3 yellow = vec3(1.0, 1.0, 0.0);        // Pure bright yellow
          vec3 white = vec3(1.0, 1.0, 1.0);         // Pure white
          vec3 red = vec3(0.765, 0.216, 0.137);     // #c33723 - original red
          
          float softSpotlight(vec2 uv, vec2 center, float radius, float softness, float rotation) {
            // Rotate UV coordinates around center
            vec2 rotated = center + mat2(cos(rotation), -sin(rotation), sin(rotation), cos(rotation)) * (uv - center);
            float dist = distance(rotated, center);
            
            // Create elliptical spotlight for more visible rotation
            vec2 offset = (rotated - center) / radius;
            float elliptical = length(offset * vec2(1.0, 0.6)); // Make it elliptical
            return smoothstep(1.0, softness, elliptical);
          }
          
          void main() {
            vec2 uv = gl_FragCoord.xy / u_resolution.xy;
            
            // Start with red background
            vec3 color = red;
            
            // Base positions with sine wave movement (closer to corners)
            vec2 blueBase = vec2(0.13, 0.87);   // Top left (flipped Y)
            vec2 yellowBase = vec2(0.87, 0.13); // Bottom right (flipped Y)
            vec2 whiteBase = vec2(0.13, 0.13);  // Bottom left (flipped Y)
            
            // Minimal movement for maximum performance
            float moveRange = 0.05;
            vec2 bluePos = blueBase + vec2(
              sin(u_time * 0.3) * moveRange,
              cos(u_time * 0.2) * moveRange
            );
            
            vec2 yellowPos = yellowBase + vec2(
              sin(u_time * 0.4) * moveRange,
              cos(u_time * 0.3) * moveRange
            );
            
            vec2 whitePos = whiteBase + vec2(
              sin(u_time * 0.5) * moveRange,
              cos(u_time * 0.4) * moveRange
            );
            
            // Rotating spotlights with specific offsets
            float blueRotation = u_time * 0.5;
            float yellowRotation = radians(10.0);
            float whiteRotation = radians(-20.0);
            
            // Create soft spotlights with rotation (blue is bigger)
            float blueLight = softSpotlight(uv, bluePos, 0.6, 0.4, blueRotation);
            float yellowLight = softSpotlight(uv, yellowPos, 0.35, 0.25, yellowRotation);
            float whiteLight = softSpotlight(uv, whitePos, 0.3, 0.2, whiteRotation);
            
            // Add spotlights to red background with higher intensity
            color = mix(color, blue, blueLight * 0.8);
            color = mix(color, yellow, yellowLight * 0.9);
            color = mix(color, white, whiteLight * 0.7);
            
            gl_FragColor = vec4(color, 1.0);
          }
        `;

        // Create shaders
        function createShader(type, source) {
          const shader = gl.createShader(type);
          gl.shaderSource(shader, source);
          gl.compileShader(shader);

          if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
            console.error(
              "Shader compilation error:",
              gl.getShaderInfoLog(shader)
            );
            gl.deleteShader(shader);
            return null;
          }
          return shader;
        }

        const vertexShader = createShader(gl.VERTEX_SHADER, vertexShaderSource);
        const fragmentShader = createShader(
          gl.FRAGMENT_SHADER,
          fragmentShaderSource
        );

        // Create program
        const program = gl.createProgram();
        gl.attachShader(program, vertexShader);
        gl.attachShader(program, fragmentShader);
        gl.linkProgram(program);

        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
          console.error(
            "Program linking error:",
            gl.getProgramInfoLog(program)
          );
          return;
        }

        gl.useProgram(program);

        // Set clear color to red background
        gl.clearColor(0.765, 0.216, 0.137, 1.0);
        gl.clear(gl.COLOR_BUFFER_BIT);

        // Enable blending for smooth color transitions
        gl.enable(gl.BLEND);
        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

        // Set up geometry
        const positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);

        const positionBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);

        const positionLocation = gl.getAttribLocation(program, "a_position");
        gl.enableVertexAttribArray(positionLocation);
        gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

        // Get uniform locations
        const resolutionLocation = gl.getUniformLocation(
          program,
          "u_resolution"
        );
        const timeLocation = gl.getUniformLocation(program, "u_time");

        // Resize handler
        function resize() {
          canvas.width = canvas.clientWidth * window.devicePixelRatio;
          canvas.height = canvas.clientHeight * window.devicePixelRatio;
          gl.viewport(0, 0, canvas.width, canvas.height);
          gl.uniform2f(resolutionLocation, canvas.width, canvas.height);
        }

        resize();
        window.addEventListener("resize", resize);

        // Ultra-optimized animation loop
        let lastTime = 0;
        const targetFPS = 15; // Reduce to 15fps for much better performance
        const frameInterval = 1000 / targetFPS;
        let isVisible = true;
        let isInViewport = true;
        
        // Pause rendering when tab is not visible
        document.addEventListener('visibilitychange', () => {
          isVisible = !document.hidden;
        });
        
        // Pause rendering when not in viewport
        const observer = new IntersectionObserver((entries) => {
          isInViewport = entries[0].isIntersecting;
        }, { threshold: 0.1 });
        observer.observe(canvas);
        
        function render(time) {
          if (isVisible && isInViewport && time - lastTime >= frameInterval) {
            gl.clear(gl.COLOR_BUFFER_BIT);
            gl.uniform1f(timeLocation, time * 0.001);
            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
            lastTime = time;
          }
          requestAnimationFrame(render);
        }

        requestAnimationFrame(render);
      }

      // Initialize WebGL background immediately and when page loads
      initTicketBackground();
      window.addEventListener("load", initTicketBackground);
    </script>
  </body>
</html>
